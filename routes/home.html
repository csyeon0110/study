<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸°ë¡ìƒí™œ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts (Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ê¸°ë³¸ í°íŠ¸ ë° ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ì ìš© */
        body, main {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease;
        }
        body { background-color: #f8f9fa; }
        
        /* ë¼ì´íŠ¸ëª¨ë“œ í¬ì¸íŠ¸ ì»¬ëŸ¬ (ë² ì´ì§€) */
        .point-bg { background-color: #E2D6C4; }
        .point-text { color: #8A745B; }
        .point-border { border-color: #E2D6C4; }
        .point-bg-hover:hover { background-color: #D1C3B2; }

        /* í™œì„±í™”ëœ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
        .sidebar-item.active {
            background-color: #E2D6C4;
            color: #6F5D49;
        }
        .sidebar-item.active svg { stroke: #6F5D49; }
        .custom-input:focus {
            border-color: #D1C3B2;
            --tw-ring-color: #D1C3B2;
        }

        /* --- ë¡œê·¸ì¸ í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ --- */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f8f9fa;
            padding: 1rem;
        }
        .login-box {
            width: 100%;
            max-width: 400px;
            background-color: white;
            padding: 2.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .login-logo {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
        }
        .login-title {
            text-align: center;
            font-size: 1.875rem;
            font-weight: 700;
            color: #1f2937;
        }
        .login-subtitle {
            text-align: center;
            margin-top: 0.5rem;
            color: #6b7280;
        }
        .login-input {
            width: 100%;
            padding: 0.75rem 1rem;
            margin-top: 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            outline: none;
            transition: all 0.2s;
        }
        .login-input:focus {
            border-color: #D1C3B2;
            box-shadow: 0 0 0 3px rgba(226, 214, 196, 0.5);
        }
        .login-button {
            width: 100%;
            padding: 0.75rem;
            margin-top: 1.5rem;
            background-color: #E2D6C4;
            color: #6F5D49;
            font-weight: 600;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .login-button:hover {
            background-color: #D1C3B2;
        }
    </style>
</head>
<body class="h-screen text-gray-800">

    <!-- ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ ë³´ì´ëŠ” ë©”ì¸ ì•± ë ˆì´ì•„ì›ƒ -->
    <div id="app-layout" class="flex h-full w-full hidden">
        <!-- 1. ê³ ì • ì‚¬ì´ë“œë°” ë©”ë‰´ -->
        <aside class="w-20 bg-white shadow-lg flex flex-col items-center py-6 space-y-6 z-10">
            <!-- ë¡œê³  -->
            <div class="w-10 h-10 point-bg rounded-lg flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" /></svg>
            </div>
            <nav class="flex flex-col items-center space-y-4">
                <a href="#" id="nav-dashboard" class="sidebar-item p-3 rounded-lg text-gray-500 hover:bg-gray-100" onclick="showPage('dashboard')"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg></a>
                <a href="#" id="nav-editor" class="sidebar-item p-3 rounded-lg text-gray-500 hover:bg-gray-100" onclick="showPage('editor')"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg></a>
                <a href="#" id="nav-challenge" class="sidebar-item p-3 rounded-lg text-gray-500 hover:bg-gray-100" onclick="showPage('challenge')"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-12v4m-2-2h4m5 4v4m-2-2h4M17 3l-4.5 5.5L17 12m-2 8l-4.5-5.5L15 19" /></svg></a>
                <!-- ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->
                <a href="#" id="nav-logout" class="sidebar-item p-3 rounded-lg text-gray-500 hover:bg-gray-100" onclick="handleLogout()">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m12.75-3h-12.75" /></svg>
                </a>
            </nav>
        </aside>

        <!-- 2. ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
        <main id="main-content" class="flex-1 overflow-y-auto">
            <!-- ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ -->
            <div id="page-dashboard" class="p-8">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">My Page</h1>
                        <p class="text-gray-500">ìµœì„œì—°ì˜ ìŠ¬ê¸°ë¡œìš´ ê¸°ë¡ìƒí™œ</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <input type="text" placeholder="ê²€ìƒ‰" class="custom-input bg-white pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 placeholder-gray-400">
                            <svg class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        </div>
                        <img src="https://placehold.co/40x40/E2D6C4/6F5D49?text=Me" alt="Profile" class="w-10 h-10 rounded-full">
                    </div>
                </header>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-gray-500 text-sm font-medium">í˜„ì¬ í¬ì¸íŠ¸</h3>
                        <p class="text-3xl font-bold text-gray-800 mt-2">1,250 P</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-gray-500 text-sm font-medium">ì´ë²ˆ ë‹¬ ê¸°ë¡</h3>
                        <p class="text-3xl font-bold text-gray-800 mt-2">15 ê±´</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow border-2 point-border">
                        <h3 class="point-text text-sm font-medium">D-Day</h3>
                        <p class="text-3xl font-bold point-text mt-2">ì¤‘ê°„ê³ ì‚¬ D-38</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">ìµœê·¼ ê¸°ë¡</h3>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                                <div>
                                    <p class="font-semibold text-gray-700">ì›¹ ìŠ¤í„°ë””_ê°œë°œ ì¼ì§€1</p>
                                    <p class="text-sm text-gray-500">2025. 09. 12.</p>
                                </div>
                                <span class="text-xs font-medium text-gray-500">#ê°œë°œ #ì›¹</span>
                            </div>
                            <div class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                                <div>
                                    <p class="font-semibold text-gray-700">ë¶€ì‚°ëŒ€ ì¹´ê³µí•˜ê¸° ì¢‹ì€ ì¹´í˜</p>
                                    <p class="text-sm text-gray-500">2025. 09. 10.</p>
                                </div>
                                <span class="text-xs font-medium text-gray-500">#ì¼ìƒ #ì¹´í˜</span>
                            </div>
                            <div class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                                <div>
                                    <p class="font-semibold text-gray-700">í”„ì›ì‹¤ ê³¼ì œ ì •ë¦¬</p>
                                    <p class="text-sm text-gray-500">2025. 09. 08.</p>
                                </div>
                                <span class="text-xs font-medium text-gray-500">#ì½”ë”© #ê³¼ì œ</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">ì˜¤ëŠ˜ì˜ ì±Œë¦°ì§€</h3>
                        <div class="space-y-3">
                            <div class="flex items-center">
                                <input id="challenge1" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-[#8A745B] focus:ring-[#D1C3B2]" checked>
                                <label for="challenge1" class="ml-3 text-gray-700">ê¸°ë¡ 1ê±´ ì‘ì„±í•˜ê¸°</label>
                            </div>
                            <div class="flex items-center">
                                <input id="challenge2" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-[#8A745B] focus:ring-[#D1C3B2]">
                                <label for="challenge2" class="ml-3 text-gray-700">ì˜¤ëŠ˜ì˜ í€´ì¦ˆ í’€ê¸°</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ê¸€ì“°ê¸° í˜ì´ì§€ -->
            <div id="page-editor" class="hidden p-8">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">My Log</h1>
                        <p class="text-gray-500">ìµœì„œì—°ì˜ ìŠ¬ê¸°ë¡œìš´ ê¸°ë¡ìƒí™œ</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <button class="px-4 py-2 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors duration-200">ì„ì‹œì €ì¥</button>
                        <button class="px-4 py-2 text-white point-bg rounded-lg point-bg-hover transition-colors duration-200 font-semibold">ë°œí–‰í•˜ê¸°</button>
                    </div>
                </header>
                <div class="bg-white p-8 rounded-lg shadow">
                    <input type="text" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" class="w-full text-4xl font-bold mb-6 pb-2 border-b bg-transparent border-gray-300 focus:outline-none focus:border-[#E2D6C4] placeholder-gray-400">
                    <textarea placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." class="w-full h-96 bg-transparent text-gray-700 leading-relaxed focus:outline-none resize-none placeholder-gray-400"></textarea>
                    <div class="mt-6 pt-4 border-t border-gray-200">
                        <input type="text" placeholder="#íƒœê·¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: #ê°œë°œ #ì¼ìƒ)" class="custom-input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 placeholder-gray-400">
                    </div>
                </div>
            </div>

            <!-- ì±Œë¦°ì§€ í˜ì´ì§€ -->
            <div id="page-challenge" class="hidden p-8">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-3xl font-bold text-white">Today's CHALLENGE</h1>
                        <p class="text-gray-400 mt-1">ë§¤ì¼ ìƒˆë¡œìš´ í€´ì¦ˆì™€ ë¯¸ì…˜ì— ë„ì „í•˜ê³  í¬ì¸íŠ¸ë¥¼ íšë“í•˜ì„¸ìš”!</p>
                    </div>
                    <img src="https://placehold.co/40x40/F59E0B/1A202C?text=Me" alt="Profile" class="w-10 h-10 rounded-full">
                </header>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-[#2D3748] p-6 rounded-lg shadow-lg flex flex-col justify-between hover:scale-105 transition-transform duration-200">
                        <div>
                            <h3 class="text-xl font-bold text-white">O/X Quiz</h3>
                            <p class="text-gray-400 mt-2">ì§„ì‹¤ í˜¹ì€ ê±°ì§“...?</p>
                        </div>
                        <div class="mt-4 flex justify-between items-center">
                            <span class="text-lg font-semibold text-[#F59E0B]">ğŸ 50 P</span>
                            <button onclick="loadQuiz()" class="bg-[#F59E0B] text-[#1A202C] font-bold py-2 px-4 rounded-lg hover:bg-amber-500 transition-colors duration-200">ë„ì „í•˜ê¸°</button>
                        </div>
                    </div>
                    <div class="bg-[#2D3748] p-6 rounded-lg shadow-lg flex flex-col justify-between hover:scale-105 transition-transform duration-200">
                        <div>
                            <h3 class="text-xl font-bold text-white">Memory Game</h3>
                            <p class="text-gray-400 mt-2">ë‚´ ê¸°ì–µë ¥ì„ í…ŒìŠ¤íŠ¸í•´ë³´ì!</p>
                        </div>
                        <div class="mt-4 flex justify-between items-center">
                            <span class="text-lg font-semibold text-[#F59E0B]">ğŸ 100 P</span>
                            <button class="bg-[#F59E0B] text-[#1A202C] font-bold py-2 px-4 rounded-lg hover:bg-amber-500 transition-colors duration-200">ë„ì „í•˜ê¸°</button>
                        </div>
                    </div>
                    <div class="bg-[#2D3748] p-6 rounded-lg shadow-lg flex flex-col justify-between opacity-60">
                        <div>
                            <h3 class="text-xl font-bold text-white">ì˜¤ëŠ˜ì˜ ë¯¸ì…˜</h3>
                            <p class="text-gray-400 mt-2">ì˜¤ëŠ˜ì˜ ì¼ìƒì´ë‚˜ í•™ìŠµ ë‚´ìš©ì„ ê¸°ë¡í•´ë³´ì„¸ìš”.(ê¸°ë¡ 1ê±´ ì‘ì„±)</p>
                        </div>
                        <div class="mt-4 flex justify-between items-center">
                            <span class="text-lg font-semibold text-gray-500">âœ” ì™„ë£Œ</span>
                            <button class="bg-gray-600 text-gray-400 font-bold py-2 px-4 rounded-lg cursor-not-allowed">ì™„ë£Œë¨</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ë¡œê·¸ì•„ì›ƒ ìƒíƒœì¼ ë•Œë§Œ ë³´ì´ëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ -->
    <div id="login-page" class="w-full hidden">
        <div class="login-container">
            <div class="login-box">
                <div class="login-logo">
                    <div class="w-12 h-12 point-bg rounded-lg flex items-center justify-center">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" /></svg>
                    </div>
                </div>
                <h1 class="login-title">ìŠ¬ê¸°ë¡œìš´ ê¸°ë¡ìƒí™œ</h1>
                <p class="login-subtitle">ë‚˜ë§Œì˜ ê³µê°„ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.</p>
                <form onsubmit="handleLogin(event)" class="mt-6">
                    <input type="text" id="username" placeholder="ì•„ì´ë””" class="login-input">
                    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸" class="login-input">
                    <button type="submit" class="login-button">ë¡œê·¸ì¸</button>
                </form>
                <p class="mt-4 text-center text-sm text-gray-500">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? <a href="#" class="font-semibold point-text hover:underline">ê°€ì…í•˜ê¸°</a></p>
            </div>
        </div>
    </div>


    <script>
        // --- í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰ë  í•¨ìˆ˜ ---
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
        });

        // --- ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ ë° UI ì—…ë°ì´íŠ¸ ---
        function checkLoginStatus() {
            if (localStorage.getItem('isLoggedIn') === 'true') {
                document.getElementById('app-layout').classList.remove('hidden');
                document.getElementById('login-page').classList.add('hidden');
                showPage('dashboard'); // ë¡œê·¸ì¸ ì‹œ ì²« í™”ë©´ì€ ëŒ€ì‹œë³´ë“œ
            } else {
                document.getElementById('app-layout').classList.add('hidden');
                document.getElementById('login-page').classList.remove('hidden');
            }
        }

        // --- ë¡œê·¸ì¸ ì²˜ë¦¬ (ì„œë²„ ì „ì†¡) ---
        async function handleLogin(event) {
            event.preventDefault(); // í¼ì˜ ê¸°ë³¸ ì œì¶œ ë™ì‘(ìƒˆë¡œê³ ì¹¨)ì„ ë§‰ìŠµë‹ˆë‹¤.

            // 1. ì…ë ¥ëœ ê°’ ê°€ì ¸ì˜¤ê¸°
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const username = usernameInput.value;
            const password = passwordInput.value;

            // 2. ì„œë²„ë¡œ ë³´ë‚¼ ë°ì´í„° ì¤€ë¹„ (JSON í˜•ì‹)
            const dataToSend = {
                username: username,
                password: password
            };

            try {
                // 3. fetchë¥¼ ì‚¬ìš©í•´ ì„œë²„ì— POST ìš”ì²­ ë³´ë‚´ê¸°
                //    '/api/login'ì€ ì‹¤ì œ ì„œë²„ì˜ ë¡œê·¸ì¸ API ì£¼ì†Œì…ë‹ˆë‹¤.
                const response = await fetch('http://localhost:3000/api/login', {
                    method: 'POST', // ìš”ì²­ ë°©ì‹
                    headers: {
                        'Content-Type': 'application/json' // ë³´ë‚´ëŠ” ë°ì´í„°ì˜ íƒ€ì…
                    },
                    body: JSON.stringify(dataToSend) // JavaScript ê°ì²´ë¥¼ JSON ë¬¸ìì—´ë¡œ ë³€í™˜
                });

                // 4. ì„œë²„ë¡œë¶€í„° ì‘ë‹µ ì²˜ë¦¬
                if (response.ok) { // HTTP ìƒíƒœ ì½”ë“œê°€ 200-299ì¼ ê²½ìš°
                    const result = await response.json(); // ì‘ë‹µ ë³¸ë¬¸ì„ JSONìœ¼ë¡œ íŒŒì‹±
                    console.log('ë¡œê·¸ì¸ ì„±ê³µ:', result);
                    
                    // ì˜ˆ: ì„œë²„ê°€ í† í°ì„ ë³´ë‚´ì£¼ë©´ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    // localStorage.setItem('token', result.token); 

                    // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ UI ì—…ë°ì´íŠ¸
                    localStorage.setItem('isLoggedIn', 'true');
                    checkLoginStatus();
                } else {
                    // ì„œë²„ê°€ ì—ëŸ¬ ì‘ë‹µì„ ë³´ëƒˆì„ ê²½ìš° (ì˜ˆ: ì•„ì´ë””/ë¹„ë²ˆ í‹€ë¦¼)
                    const errorData = await response.json();
                    alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + (errorData.message || 'ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'));
                }
            } catch (error) {
                // ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ë“± fetch ìš”ì²­ ìì²´ê°€ ì‹¤íŒ¨í–ˆì„ ê²½ìš°
                console.error('ë¡œê·¸ì¸ ìš”ì²­ ì¤‘ ì—ëŸ¬ ë°œìƒ:', error);
                alert('ì„œë²„ì™€ í†µì‹  ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // --- ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ---
        function handleLogout() {
            // ì‹¤ì œë¡œëŠ” ì„œë²„ì— ë¡œê·¸ì•„ì›ƒ ìš”ì²­ì„ ë³´ë‚´ í† í°ì„ ë¬´íš¨í™”í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
            localStorage.removeItem('isLoggedIn');
            // localStorage.removeItem('token');
            checkLoginStatus();
        }

        // --- í˜ì´ì§€ ì „í™˜ ìŠ¤í¬ë¦½íŠ¸ ---
        function showPage(pageId) {
            const mainContent = document.getElementById('main-content');
            
            // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
            const pages = mainContent.children;
            for (let page of pages) {
                page.classList.add('hidden');
            }

            // í´ë¦­ëœ í˜ì´ì§€ ë³´ì´ê¸°
            document.getElementById('page-' + pageId).classList.remove('hidden');
            
            // í…Œë§ˆ ë³€ê²½
            if (pageId === 'challenge') {
                mainContent.style.backgroundColor = '#1A202C';
            } else {
                mainContent.style.backgroundColor = '#f8f9fa';
            }

            // ë©”ë‰´ í™œì„±í™” ìŠ¤íƒ€ì¼
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.getElementById('nav-' + pageId).classList.add('active');
        }

        // --- ì „ì—­ ë³€ìˆ˜ ---
        let currentCorrectAnswer = ''; // í€´ì¦ˆì˜ ì •ë‹µì„ ì €ì¥í•  ë³€ìˆ˜

        // --- ì±Œë¦°ì§€ í˜ì´ì§€ ì „ìš© í•¨ìˆ˜ ---

        // HTML íŠ¹ìˆ˜ë¬¸ì ë””ì½”ë” (APIê°€ &quot; ê°™ì´ ë³´ë‚´ì£¼ëŠ”ê±¸ "ë¡œ ë°”ê¿”ì¤Œ)
        function decodeHTML(html) {
            const txt = document.createElement("textarea");
            txt.innerHTML = html;
            return txt.value;
        }

        // O/X í€´ì¦ˆ ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°
        function showChallengeMenu() {
            const menu = document.getElementById('challenge-menu');
            const quizArea = document.getElementById('quiz-area');
            if(menu) {
                menu.classList.remove('hidden');
            }
            if(quizArea) {
                quizArea.classList.add('hidden');
                quizArea.innerHTML = ''; // í€´ì¦ˆ ë‚´ìš© ì´ˆê¸°í™”
            }
        }

        // í€´ì¦ˆ ë¶ˆëŸ¬ì˜¤ê¸° (API ì—°ë™)
        async function loadQuiz() {
            console.log("í€´ì¦ˆ ë¶ˆëŸ¬ì˜¤ê¸° ì‹œì‘");
            // 'ë„ì „í•˜ê¸°' ë²„íŠ¼ ë¹„í™œì„±í™” (ì—°ì† í´ë¦­ ë°©ì§€)
            // const quizButton = document.querySelector('#challenge-menu button[onclick="loadQuiz()"]');
            // if (quizButton) quizButton.disabled = true; // ì¿¨ë‹¤ìš´ ë¡œì§ ë³€ê²½ìœ¼ë¡œ ì¼ë‹¨ ì œê±°

            const menu = document.getElementById('challenge-menu');
            const quizArea = document.getElementById('quiz-area');

            if(!menu || !quizArea) return;

            menu.classList.add('hidden');
            quizArea.classList.remove('hidden');
            quizArea.innerHTML = `<p class="text-white text-center text-lg">ìƒˆë¡œìš´ í€´ì¦ˆë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>`;

            try {
                // OTDB API í˜¸ì¶œ: ì¼ë°˜ ìƒì‹(category=9), OXí€´ì¦ˆ(type=boolean) 1ë¬¸ì œ
                const response = await fetch('https://opentdb.com/api.php?amount=1&category=9&type=boolean');
                
                if (!response.ok) {
                    // 429 ì—ëŸ¬(Too Many Requests)ë¥¼ ìœ„í•œ íŠ¹ë³„ ë©”ì‹œì§€ ì²˜ë¦¬
                    if (response.status === 429) {
                        throw new Error('TooManyRequests');
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();

                if (data.results.length === 0) {
                    quizArea.innerHTML = `<p class="text-red-400 text-center">í€´ì¦ˆë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. <a href="#" onclick="showChallengeMenu()" class="underline">ëŒì•„ê°€ê¸°</a></p>`;
                    return;
                }

                const quiz = data.results[0];
                currentCorrectAnswer = quiz.correct_answer; // ì •ë‹µ ì €ì¥

                // APIê°€ ë³´ë‚´ì¤€ ì§ˆë¬¸ í…ìŠ¤íŠ¸ë¥¼ ë””ì½”ë”©
                const questionText = decodeHTML(quiz.question);

                // í€´ì¦ˆ í™”ë©´ HTML ìƒì„±
                quizArea.innerHTML = `
                    <div class="bg-[#2D3748] p-8 rounded-lg shadow-lg max-w-2xl mx-auto">
                        <p class="text-gray-400 text-sm">ì¼ë°˜ ìƒì‹ O/X í€´ì¦ˆ</p>
                        <h2 class="text-2xl font-bold text-white text-center my-6 min-h-[100px] flex items-center justify-center">${questionText}</h2>
                        <div class="flex justify-center space-x-8">
                            <button id="btn-true" onclick="checkAnswer('True')" class="bg-green-500 text-white font-bold py-4 px-10 rounded-lg text-2xl hover:bg-green-400 transition-colors">O (True)</button>
                            <button id="btn-false" onclick="checkAnswer('False')" class="bg-red-500 text-white font-bold py-4 px-10 rounded-lg text-2xl hover:bg-red-400 transition-colors">X (False)</button>
                        </div>
                        <div id="quiz-feedback" class="text-center text-white text-lg mt-6"></div>
                        <div class="text-center mt-6">
                            <button onclick="showChallengeMenu()" class="text-gray-400 hover:text-white underline">ì±Œë¦°ì§€ ë©”ë‰´ë¡œ</button>
                        </div>
                    </div>
                `;

            } catch (error) {
                console.error("í€´ì¦ˆ ë¡œë”© ì‹¤íŒ¨:", error);
                // 429 ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©ìì—ê²Œ ì¹œì ˆí•˜ê²Œ ì•ˆë‚´
                if (error.message === 'TooManyRequests') {
                     quizArea.innerHTML = `<p class="text-yellow-400 text-center">ë„ˆë¬´ ë§ì€ ìš”ì²­ì„ ë³´ëƒˆìŠµë‹ˆë‹¤.<br>ì ì‹œ í›„ (ì•½ 5ì´ˆ) ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.<br><br><a href="#" onclick="showChallengeMenu()" class="underline">ëŒì•„ê°€ê¸°</a></p>`;
                } else {
                    quizArea.innerHTML = `<p class="text-red-400 text-center">í€´ì¦ˆ ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ. <br>(${error.message}) <br><a href="#" onclick="showChallengeMenu()" class="underline">ëŒì•„ê°€ê¸°</a></p>`;
                }
                
                // â˜…â˜…â˜… ìˆ˜ì •ëœ ë¶€ë¶„ â˜…â˜…â˜…
                // ë¡œë”© ì‹¤íŒ¨ ì‹œ, 5ì´ˆ í›„ì— ë©”ë‰´ë¡œ ëŒì•„ê°€ì„œ ë‹¤ì‹œ ì‹œë„í•  ìˆ˜ ìˆê²Œ í•¨
                setTimeout(() => {
                    showChallengeMenu();
                }, 5000); // 5ì´ˆ ì¿¨ë‹¤ìš´
            }
            // 'finally' ë¸”ë¡ ì œê±°
        }

        // ì •ë‹µ í™•ì¸
        function checkAnswer(selectedAnswer) {
            const feedbackEl = document.getElementById('quiz-feedback');
            const btnTrue = document.getElementById('btn-true');
            const btnFalse = document.getElementById('btn-false');

            // ë²„íŠ¼ ë¹„í™œì„±í™”
            if(btnTrue) btnTrue.disabled = true;
            if(btnFalse) btnFalse.disabled = true;

            let feedbackMessage = '';

            if (selectedAnswer === currentCorrectAnswer) {
                feedbackMessage = `<span class="text-green-400 font-bold">ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤! +50 P</span>`;
                // ì •ë‹µ ë²„íŠ¼ì— ê°•ì¡° íš¨ê³¼
                if(selectedAnswer === 'True') btnTrue.classList.add('ring-4', 'ring-green-400');
                if(selectedAnswer === 'False') btnFalse.classList.add('ring-4', 'ring-green-400');
            } else {
                feedbackMessage = `<span class="text-red-400 font-bold">ğŸ˜¥ ì˜¤ë‹µì…ë‹ˆë‹¤. (ì •ë‹µ: ${currentCorrectAnswer})</span>`;
                // ì˜¤ë‹µ ë²„íŠ¼ì— íš¨ê³¼
                if(selectedAnswer === 'True') btnTrue.classList.add('ring-4', 'ring-red-500');
                if(selectedAnswer === 'False') btnFalse.classList.add('ring-4', 'ring-red-500');
            }

            // --- â˜…â˜…â˜… ì—¬ê¸°ê°€ í•µì‹¬ ìˆ˜ì • ë¶€ë¶„ì…ë‹ˆë‹¤ â˜…â˜…â˜… ---

            // 1. í”¼ë“œë°± ë©”ì‹œì§€ í‘œì‹œ (ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ ì—†ìŒ)
            feedbackEl.innerHTML = feedbackMessage;

            // 2. ì¹´ìš´íŠ¸ë‹¤ìš´ ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•  <p> íƒœê·¸ ìƒì„±
            const timerEl = document.createElement('p');
            timerEl.id = 'next-quiz-timer';
            timerEl.className = 'text-yellow-400 mt-4';
            let seconds = 3; // API ì¿¨ë‹¤ìš´ 5ì´ˆ
            timerEl.textContent = `${seconds}ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤...`;
            feedbackEl.appendChild(timerEl);

            // 3. 1ì´ˆë§ˆë‹¤ ì¹´ìš´íŠ¸ë‹¤ìš´ ì—…ë°ì´íŠ¸
            const interval = setInterval(() => {
                seconds--;
                if (seconds > 0) {
                    timerEl.textContent = `${seconds}ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤...`;
                } else {
                    clearInterval(interval); // 0ì´ˆê°€ ë˜ë©´ ì¹´ìš´íŠ¸ë‹¤ìš´ ì¤‘ì§€
                }
            }, 1000);

            // 4. 5ì´ˆ í›„ì— 'loadQuiz' í•¨ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ í˜¸ì¶œ
            setTimeout(() => {
                loadQuiz();
            }, 5000);
        }

    </script>
</body>
</html>

